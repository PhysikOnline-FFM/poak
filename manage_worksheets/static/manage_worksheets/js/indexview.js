// Generated by CoffeeScript 1.7.1
(function() {
  var on_change_tag;

  String.prototype.format = function() {
    var args;
    args = arguments;
    return this.replace(/\{(\d+)\}/g, function(m, n) {
      return args[n];
    });
  };

  $(function() {
    var ws_html;
    $.getJSON("tags", function(data) {
      var tag_html;
      tag_html = '<li><input type="checkbox" name="tag" value="{0}" id="tag{0}"/> <label for="tag{0}">{1}</label></li>';
      return $.each(data.tags, function(index, tag) {
        $("#tags ul").append($("<li>").append(tag_html.format(tag[0], tag[1])));
        return $("#tag" + tag[0]).change(function() {
          return on_change_tag($(this));
        });
      });
    });
    ws_html = '<li><a href="{0}/{1}"><span class="ws_link">{2}</span></a> <a href="{3}{1}">(Kommentare)</a></li>';
    return $.getJSON("worksheet_list", function(data) {
      var details_base_url, pokal_url, worksheets;
      worksheets = data.worksheet_list;
      pokal_url = data.pokal_url;
      details_base_url = data.details_base_url;
      return $.each(worksheets, function(index, worksheet_id) {
        return $.getJSON("worksheet_details/" + worksheet_id, function(worksheet) {
          return $("#worksheets ul").append(ws_html.format(pokal_url, worksheet.worksheet_id, worksheet.title, details_base_url));
        });
      });
    });
  });

  on_change_tag = function(tag_obj) {
    return $.getJSON("worksheets_for_tag/" + tag_obj.attr("value"), function(data) {
      var worksheet_ids;
      worksheet_ids = data.worksheet_list;
      return alert("passende worksheets: " + worksheet_ids.join());
    });
  };

}).call(this);
